<html>
    <head>
        <title>Find the Differences Exercise </title>
        <link href="style.css" type="text/css" rel="stylesheet">
    </head>
    <body>
        <div id="main">
            <h1>Find the Differences</h1>
            <h2 id="numberMatches"> </h2>
            <h3 id="numLeft"> </h3>
            <hr>
            <p id="demo"></p>
            <img id="image1" src="images/img1.jpg" >
            <img id="image2" src="images/img2.jpg" >
        </div>
    </body>
    <script>
        console.log(document.URL)
        imageMatchPoints = [{x: 97,y: 173.91,clicked: false, rangeX: 32, rangeY: 19 },
                            {x: 99, y: 372.41, clicked: false, rangeX: 47, rangeY: 19.5 },
                            {x: 420.5, y: 110.41, clicked: false, rangeX: 58.5, rangeY: 91.5 },
                            {x: 302, y: 440.41, clicked: false, rangeX: 18, rangeY: 20.5 },
                            {x: 431, y: 354.41, clicked: false, rangeX: 19, rangeY: 24.5 }]
        console.log(imageMatchPoints);
        var numberOfMatches = imageMatchPoints.length;
        document.getElementById("numberMatches").textContent = "There are a total of "+numberOfMatches+" matches to find.";
        document.getElementById("demo").textContent = "You found: \n";
        var count = 0;
        function getMousePosition(image,event){

            let imageBox = image.getBoundingClientRect();
            let x = event.clientX - imageBox.left;
            let y = event.clientY - imageBox.top;
            console.log("X: "+x, "Y: " +y);
            var i;
            
            
            for( i = 0; i< imageMatchPoints.length; i++){
                if (x >= imageMatchPoints[i].x-imageMatchPoints[i].rangeX && x <= imageMatchPoints[i].x+imageMatchPoints[i].rangeX){
                    if (y>= imageMatchPoints[i].y-imageMatchPoints[i].rangeY && y <= imageMatchPoints[i].y + imageMatchPoints[i].rangeY){
                        if (imageMatchPoints[i].clicked == false){
                            document.getElementById("demo").textContent += "match " + (i+1) + ",\n\r ";
                            imageMatchPoints[i].clicked=true
                            count +=1;
                            document.getElementById("numLeft").textContent = " " + (numberOfMatches-count)+" matches left to find!";
                            console.log(count)
                        }
                        
                    }
                    
                }
            }
            if(count == numberOfMatches){
                congratsMessage = "Congratulations! You found all of the matches!!!!";
                document.getElementById("numLeft").textContent = " ";
                document.getElementById("demo").style.fontWeight= "bold";
                document.getElementById("demo").style.textAlign = "center";
                document.getElementById("demo").style.color = "green";
                document.getElementById("demo").textContent = "\r" + "\n"+congratsMessage;
            }
            
        }
        let imageElem = document.querySelectorAll("img");
        let image1elem = imageElem[0];
        console.log(imageElem)
        image1elem.addEventListener("mousedown",function(e){
            getMousePosition(image1elem,e)
        })
        let image2elem = imageElem[1];
        image2elem.addEventListener("mousedown",function(e){
            getMousePosition(image2elem,e)
        })
    </script>
</html>